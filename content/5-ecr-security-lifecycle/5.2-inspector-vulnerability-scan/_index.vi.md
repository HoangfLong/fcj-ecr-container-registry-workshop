---
title: "Vulnerability Scanning với Inspector"
weight: 2
chapter: false
pre: "<b> 5.2. </b>"
---

Bảo mật là một khía cạnh cực kỳ quan trọng đối với các ứng dụng container. Ngay cả khi bạn đã xây dựng image từ Dockerfile của mình, nó vẫn có thể chứa các thư viện hoặc gói phần mềm có lỗ hổng bảo mật đã biết. Amazon ECR tích hợp chặt chẽ với Amazon Inspector để cung cấp khả năng quét lỗ hổng tự động cho các Docker image của bạn. Điều này giúp bạn phát hiện sớm các rủi ro bảo mật và giảm thiểu bề mặt tấn công.

#### Mục tiêu của phần này

* Hiểu tầm quan trọng của việc quét lỗ hổng bảo mật cho Docker image.
* Kích hoạt dịch vụ Amazon Inspector cho tài khoản AWS của bạn.
* Cấu hình tính năng quét lỗ hổng nâng cao (Enhanced scanning) được hỗ trợ bởi Amazon Inspector trong ECR.
* Xem và phân tích các kết quả quét lỗ hổng để hiểu rõ hơn về các rủi ro tiềm ẩn.

### Tổng quan về Quét lỗ hổng trong ECR

Amazon ECR cung cấp hai loại quét lỗ hổng:

1.  **Basic scanning (Quét cơ bản):** Sử dụng cơ sở dữ liệu Common Vulnerabilities and Exposures (CVE) của Clair để quét các gói hệ điều hành. Đây là tùy chọn quét mặc định và ít toàn diện hơn.
2.  **Enhanced scanning (Quét nâng cao):** Được cung cấp bởi **Amazon Inspector**, đây là tùy chọn quét được khuyến nghị. Inspector cung cấp khả năng quét toàn diện hơn, bao gồm các lỗ hổng cấp độ hệ điều hành và gói phần mềm ứng dụng, cũng như thông tin về mức độ dễ bị khai thác và các biện pháp khắc phục. Quét nâng cao có thể được cấu hình để quét liên tục các image khi chúng được đẩy lên và quét lại định kỳ khi có thông tin lỗ hổng mới.

Trong workshop này, chúng ta sẽ kích hoạt **Enhanced scanning** với Amazon Inspector để có được cái nhìn toàn diện nhất về bảo mật image của chúng ta.

### Kích hoạt Quét lỗ hổng bằng Amazon Inspector

Để ECR có thể sử dụng Amazon Inspector cho việc quét nâng cao, bạn cần đảm bảo dịch vụ Amazon Inspector đã được kích hoạt trong tài khoản AWS của mình.


1.    Trong thanh tìm kiếm, gõ "Inspector" và chọn **Amazon Inspector**.
    {{< figure src="/fcj-ecr-container-registry-workshop/images/5/5.2/005-a.png" alt="Kích hoạt Amazon Inspector" >}} 
2.    Nếu đây là lần đầu tiên bạn truy cập Inspector hoặc dịch vụ chưa được kích hoạt, bạn sẽ thấy một trang chào mừng. Nhấp vào nút **Activate Inspector** (hoặc tương tự) để kích hoạt dịch vụ.
     {{< figure src="/fcj-ecr-container-registry-workshop/images/5/5.2/005-b.png" alt="Kích hoạt Amazon Inspector" >}}
     {{% notice info %}}
  Amazon Inspector là một dịch vụ trả phí. Việc kích hoạt nó sẽ phát sinh chi phí nhỏ dựa trên số lượng image được quét và dữ liệu được phân tích. Đảm bảo bạn tắt nó sau khi hoàn thành workshop nếu không còn nhu cầu sử dụng.
{{% /notice %}}
    {{< figure src="/fcj-ecr-container-registry-workshop/images/5/5.2/005.png" alt="Kích hoạt Amazon Inspector" >}}

1.  Truy cập dịch vụ ECR:
    * Sau khi đã kích hoạt Inspector, quay lại thanh tìm kiếm, gõ "ECR" và chọn **Elastic Container Registry**.

2.  Cấu hình Enhanced Scanning cho tài khoản trong ECR:
    * Trong bảng điều khiển ECR, nhấp vào **Scan settings** ở thanh điều hướng bên trái Features & Settings chọn Scanning.
    * Tại đây, bạn sẽ thấy tùy chọn để cấu hình loại quét mặc định cho các repository mới. Chọn **Enhanced scanning**.
    * Nhấp **Save** để lưu cấu hình này.

    {{< figure src="/fcj-ecr-container-registry-workshop/images/5/5.2/001.png" alt="Cấu hình Enhanced scanning trong ECR" >}}

3.  Xác nhận cấu hình quét image cho Repository:
    * Quay lại **Repositories**.
    * Nhấp vào repository `fcj-workshop-app` của bạn.
    * chọn vào image của bạn và và nhấn vào **Details**

    {{< figure src="/fcj-ecr-container-registry-workshop/images/5/5.2/002.png" alt="Cấu hình quét image cho repository" >}}

    {{< figure src="/fcj-ecr-container-registry-workshop/images/5/5.2/002-b.png" alt="Cấu hình quét image cho repository" >}}
    
  {{% notice note %}}
  Với Enhanced scanning được bật, các image mới đẩy lên repository sẽ tự động được quét. Các image đã tồn tại có thể cần một thời gian để quét lần đầu hoặc bạn cần đẩy một phiên bản mới để kích hoạt quét.
{{% /notice %}}
### Xem và Phân tích Kết quả Quét

Sau khi quá trình quét hoàn tất (thường mất vài phút), bạn có thể xem kết quả ngay trong ECR console.

6. Trong bảng điều khiển ECR, nhấp vào **Repositories**.
   
    {{< figure src="/fcj-ecr-container-registry-workshop/images/5/5.2/006.png" alt="Tổng quan kết quả quét image" >}}

2. Nhấp vào repository `fcj-workshop-app` của bạn.
   
    
3. Nhấp vào **tag** của image mà bạn muốn kiểm tra chi tiết và chọn vào image của bạn và vnhấn vào Details.
   
      {{< figure src="/fcj-ecr-container-registry-workshop/images/5/5.2/002.png" alt="Cấu hình quét image cho repository" >}}

4. Trong trang chi tiết của image, nhấp vào tab **See extended details in Inspector**.
      {{< figure src="/fcj-ecr-container-registry-workshop/images/5/5.2/009.png" alt="Chi tiết các lỗ hổng trong ECR" >}}
    * Bạn sẽ thấy danh sách đầy đủ các lỗ hổng được tìm thấy, được phân loại theo mức độ nghiêm trọng. Mỗi lỗ hổng sẽ hiển thị các thông tin như:
        * **Severity (Mức độ nghiêm trọng):** Critical, High, Medium, Low, Informational.
        * **CVE ID:** Mã định danh của lỗ hổng (ví dụ: `CVE-2023-XXXX`).
        * **Package:** Gói phần mềm bị ảnh hưởng.
        * **Fixed in version:** Phiên bản mà lỗ hổng đã được khắc phục (nếu có).
        * **Description:** Mô tả ngắn gọn về lỗ hổng.
    * Nhấp vào từng CVE ID để xem thông tin chi tiết hơn, bao gồm mô tả đầy đủ, điểm CVSS, và các liên kết đến nguồn thông tin bên ngoài để hiểu rõ hơn về tác động và cách khắc phục.
  {{< figure src="/fcj-ecr-container-registry-workshop/images/5/5.2/010.png" alt="Chi tiết các lỗ hổng trong ECR" >}}
 

    {{% notice info %}}
  Các phát hiện về lỗ hổng của ECR images cũng được tổng hợp và hiển thị trong bảng điều khiển của Amazon Inspector. Bạn có thể truy cập dịch vụ Inspector và vào phần "Findings" (Phát hiện) để xem một cái nhìn tổng thể về tất cả các lỗ hổng được phát hiện trên các tài nguyên khác nhau của bạn (bao gồm cả image ECR).
    {{% /notice %}}

    {{% notice info %}}
  Việc quét lỗ hổng giúp bạn nhận diện các rủi ro bảo mật trong image. Mặc dù không phải tất cả các lỗ hổng "Informational" hoặc "Low" đều cần được ưu tiên ngay lập tức, các lỗ hổng `Critical` và `High` yêu cầu sự chú ý ngay lập tức. Bạn nên cập nhật các gói phần mềm bị ảnh hưởng lên phiên bản đã được khắc phục để giảm thiểu rủi ro.
    {{% /notice %}}

Việc kích hoạt và theo dõi quét lỗ hổng là một bước quan trọng trong việc duy trì chuỗi cung ứng phần mềm an toàn cho các ứng dụng container của bạn.

---