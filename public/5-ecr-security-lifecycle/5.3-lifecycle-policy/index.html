<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head><script src="/fcj-ecr-container-registry-workshop/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=fcj-ecr-container-registry-workshop/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.147.9">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/fcj-ecr-container-registry-workshop/images/favicon.png" type="image/png">

    <title>ECR Image Lifecycle Management :: Create a new AWS account.</title>

    
    <link href="/fcj-ecr-container-registry-workshop/css/nucleus.css?1752202651" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/fontawesome-all.min.css?1752202651" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/hybrid.css?1752202651" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/featherlight.min.css?1752202651" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/perfect-scrollbar.min.css?1752202651" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/auto-complete.css?1752202651" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/atom-one-dark-reasonable.css?1752202651" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/theme.css?1752202651" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/hugo-theme.css?1752202651" rel="stylesheet">
    
    <link href="/fcj-ecr-container-registry-workshop/css/theme-workshop.css?1752202651" rel="stylesheet">
    
    

    <script src="/fcj-ecr-container-registry-workshop/js/jquery-3.3.1.min.js?1752202651"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.3-lifecycle-policy/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/fcj-ecr-container-registry-workshop/js/lunr.min.js?1752202651"></script>
<script type="text/javascript" src="/fcj-ecr-container-registry-workshop/js/auto-complete.js?1752202651"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/localhost:1313\/fcj-ecr-container-registry-workshop\/";
    
</script>
<script type="text/javascript" src="/fcj-ecr-container-registry-workshop/js/search.js?1752202651"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/1-introduction/" title="Introduction" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/1-introduction/">
          <b> 1. </b>Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/2-prerequisites/" title="Prerequisites" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/2-prerequisites/">
          <b> 2. </b>Prerequisites
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/3-iam-configuration/" title="IAM Configuration" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/3-iam-configuration/">
          <b> 3. </b>IAM Configuration
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/3-iam-configuration/3.1-set-up-iam/" title="Configure IAM Roles and Policies" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/3-iam-configuration/3.1-set-up-iam/">
          <b> 3.1. </b>Configure IAM Roles and Policies
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/" title="CI/CD with GitHub Actions" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/">
          <b> 4. </b>CI/CD with GitHub Actions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.1-prepare-github-repo/" title="Prepare GitHub Repository" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.1-prepare-github-repo/">
          <b> 4.1. </b>Prepare GitHub Repository
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.2-build-github-actions/" title="GitHub Actions Workflow" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.2-build-github-actions/">
          <b> 4.2. </b>GitHub Actions Workflow
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.3-run-pipeline/" title="Run and Test the Pipeline" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.3-run-pipeline/">
          <b> 4.3. </b>Run and Test the Pipeline
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/" title="ECR Security &amp; Lifecycle" class="dd-item 
        parent
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/">
          <b> 5. </b>ECR Security &amp; Lifecycle
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.1-repository-policy/" title="Repository Access Policy" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.1-repository-policy/">
          <b> 5.1. </b>Repository Access Policy
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.2-inspector-vulnerability-scan/" title="Vulnerability Scanning with Inspector" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.2-inspector-vulnerability-scan/">
          <b> 5.2. </b>Vulnerability Scanning with Inspector
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.3-lifecycle-policy/" title="ECR Image Lifecycle Management" class="dd-item 
        
        active
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.3-lifecycle-policy/">
          <b> 5.3. </b>ECR Image Lifecycle Management
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/6-monitoring-alerts/" title="Monitoring &amp; Alerts" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/6-monitoring-alerts/">
          <b> 6. </b>Monitoring &amp; Alerts
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/6-monitoring-alerts/6.1-cloudtrail-cloudwatch/" title="CloudTrail and CloudWatch" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/6-monitoring-alerts/6.1-cloudtrail-cloudwatch/">
          <b> 6.1. </b>CloudTrail and CloudWatch
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/7-clean-up-resources/" title="Clean-up Resources" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/7-clean-up-resources/">
          <b> 7. </b>Clean-up Resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://aws.amazon.com/blogs"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj"><i class='fab fa-facebook'></i> AWS Study Group - FB Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="http://localhost:1313/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.3-lifecycle-policy/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="http://localhost:1313/fcj-ecr-container-registry-workshop/vi/5-ecr-security-lifecycle/5.3-lifecycle-policy/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830891&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>26-11-2023</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng</a>
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/fcj-ecr-container-registry-workshop/'>Container Registry Management with ECR and Security Policies</a> > <a href='/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/'>ECR Security & Lifecycle</a> > ECR Image Lifecycle Management
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
        <li><a href="#overview-of-lifecycle-policies-in-ecr">Overview of Lifecycle Policies in ECR</a></li>
        <li><a href="#configuring-lifecycle-policies-in-ecr">Configuring Lifecycle Policies in ECR</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              ECR Image Lifecycle Management
            </h1>
          

        



	<p>Security and cost management are two critical factors when working with Docker images in Amazon ECR. By default, ECR retains all your image versions indefinitely, which can lead to an accumulation of unnecessary old images, increasing storage costs and making the repository cluttered.</p>
<p>ECR Lifecycle Policies allow you to automatically manage these images. You can configure rules to delete images based on age, tag status (tagged/untagged), or image count. This helps you maintain clean ECR repositories, keeping only necessary images and optimizing costs.</p>
<h4 id="objectives-of-this-section">Objectives of this section</h4>
<ul>
<li>Understand the importance of lifecycle management for Docker images.</li>
<li>Create and configure ECR lifecycle policies to automatically clean up old images.</li>
<li>Understand how lifecycle rules work and their impact on your images.</li>
</ul>
<h3 id="overview-of-lifecycle-policies-in-ecr">Overview of Lifecycle Policies in ECR</h3>
<p>A lifecycle policy consists of one or more rules. Each rule defines an action (typically deletion) based on specific criteria. Common criteria include:</p>
<ul>
<li><strong>Age:</strong> Delete images older than a certain number of days.</li>
<li><strong>Count:</strong> Retain the N most recent images and delete older ones.</li>
<li><strong>Tag Status:</strong> Delete untagged images or images with specific tags.</li>
</ul>
<p>Rules are enforced according to the Rule Priority you define.</p>
<h3 id="configuring-lifecycle-policies-in-ecr">Configuring Lifecycle Policies in ECR</h3>
<p>Now we will create a lifecycle policy for our <code>fcj-workshop-app</code> repository.</p>
<ol>
<li>
<p>Ensure you are in the ECR dashboard:</p>
<ul>
<li>In the AWS Console search bar, type &ldquo;ECR&rdquo; and select <strong>Elastic Container Registry</strong>.
<figure><img src="/fcj-ecr-container-registry-workshop/images/5/5.3/001.png"
        alt="Select fcj-workshop-app repository from the list">
    </figure>
</li>
</ul>
</li>
<li>
<p>Select the <code>fcj-workshop-app</code> Repository:</p>
<ul>
<li>From the list of repositories, click on the name of your <code>fcj-workshop-app</code> repository.</li>
</ul>
</li>
<li>
<p>Navigate to the &ldquo;Lifecycle policy&rdquo; tab:</p>
<ul>
<li>On the <code>fcj-workshop-app</code> repository details page, click the <strong>Lifecycle policy</strong> tab.
<figure><img src="/fcj-ecr-container-registry-workshop/images/5/5.3/002.png"
        alt="Navigate to Lifecycle policy tab">
    </figure>
</li>
</ul>
</li>
<li>
<p>Click the &ldquo;Create rule&rdquo; button:</p>
<ul>
<li>On the &ldquo;Lifecycle policy&rdquo; tab, you will see the <strong>Create rule</strong> button. Click it to start defining rules for the policy.
<figure><img src="/fcj-ecr-container-registry-workshop/images/5/5.3/003.png"
        alt="Click Create rule button">
    </figure>
</li>
</ul>

<div class="notices note" ><p>Before applying the policy, it is recommended to create and test the rule (test rule) to preview which images will be deleted. This helps you avoid unintended data loss.</p>
</div>

</li>
<li>
<p>Configure the first rule: Delete Untagged Images:</p>
<ul>
<li>Add a new rule with the following settings:
<ul>
<li><strong>Rule priority:</strong> <code>1</code> (Highest priority)</li>
<li><strong>Rule description:</strong> <code>Delete untagged images</code></li>
<li><strong>Image status:</strong> <code>Untagged</code></li>
<li><strong>Action:</strong> <code>Expire images</code></li>
<li><strong>Since image pushed</strong>: <code>1</code> (day)
<figure><img src="/fcj-ecr-container-registry-workshop/images/5/5.3/003-a.png"
        alt="Configure rule to delete untagged images">
    </figure>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Configure Rule 2: Keep the 3 most recent tagged images and delete older ones:</p>
<ul>
<li>Click &ldquo;Create rule&rdquo; again and configure the second rule with the following settings:
<ul>
<li><strong>Rule priority:</strong> <code>2</code></li>
<li><strong>Rule description:</strong> <code>Keep latest 3 tagged images, delete others</code></li>
<li><strong>Image status:</strong> <code>Tagged</code></li>
<li><strong>Specify tags for wildcard matching:</strong> <strong>Enter <code>*</code></strong> (This is a <strong>REQUIRED wildcard character</strong> for the rule to apply to ALL tagged images when using the &ldquo;Image count greater than&rdquo; criteria. ECR requires you to enter at least one tag pattern.)</li>
<li><strong>Match criteria:</strong> <code>Image count greater than</code></li>
<li><strong>Value:</strong> <code>3</code></li>
<li><strong>Action:</strong> <code>Expire images</code>
<figure><img src="/fcj-ecr-container-registry-workshop/images/5/5.3/003-b.png"
        alt="Configure rule to keep latest 3 tagged images">
    </figure>
</li>
</ul>
</li>
</ul>

<div class="notices note" ><p>Once all rules for the policy have been defined, you should simulate the policy to preview its impact before officially creating it.</p>
</div>

</li>
<li>
<p>Push More Images to the Repository to Test the Policy:</p>
<ul>
<li>To have enough data for the lifecycle policy to operate and for you to see clear simulation results, repeat the steps for pushing images to the ECR repository (as done in Section 4.3. <a href="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.3-run-pipeline/">Run and test Pipeline</a>).</li>
<li>You should push approximately <strong>5 new images</strong> with different tags (e.g., <code>v0.0.2</code>, <code>v0.0.3</code>, <code>v0.0.4</code>, <code>v0.0.5</code>, <code>v0.0.6</code>). Ensure each push is a new version to create distinct images.</li>
</ul>
</li>
<li>
<p>Simulate policy to preview its impact:</p>
<ul>
<li>After <strong>defining all rules</strong> for the policy, you should run a simulation to see which images will be affected (deleted) before actual application. On the policy creation interface:</li>
<li>The simulation results will show a list of images that would be deleted if this policy were executed. This helps you avoid accidentally deleting important images.</li>
<li>Go back to your ECR repository and select Lifecycle Policy.</li>
<li>Choose Actions.</li>
<li>Select copy policy to test rules.
<figure><img src="/fcj-ecr-container-registry-workshop/images/5/5.3/006.png"
        alt="Simulate lifecycle policy to preview impact">
    </figure>
</li>
</ul>
</li>
<li>
<p>Select the rule you want to test run:</p>
<ul>
<li>Choose run test.
<figure><img src="/fcj-ecr-container-registry-workshop/images/5/5.3/007.png"
        alt="Review and create lifecycle policy">
    </figure>
</li>
</ul>
</li>
<li>
<p>Check the test run:</p>
<figure><img src="/fcj-ecr-container-registry-workshop/images/5/5.3/008.png"
        alt="Lifecycle policy successfully created">
    </figure>

</li>
</ol>
<p>Implementing a lifecycle policy helps automate the cleanup process, ensuring that your ECR repository is always optimized and contains only the necessary images.</p>
<hr>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.2-inspector-vulnerability-scan/" title="Vulnerability Scanning with Inspector"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/fcj-ecr-container-registry-workshop/6-monitoring-alerts/" title="Monitoring &amp; Alerts" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/fcj-ecr-container-registry-workshop/js/clipboard.min.js?1752202651"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/perfect-scrollbar.min.js?1752202651"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/perfect-scrollbar.jquery.min.js?1752202651"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/jquery.sticky.js?1752202651"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/featherlight.min.js?1752202651"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/highlight.pack.js?1752202651"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/fcj-ecr-container-registry-workshop/js/modernizr.custom-3.6.0.js?1752202651"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/learn.js?1752202651"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/hugo-learn.js?1752202651"></script>

    <link href="/fcj-ecr-container-registry-workshop/mermaid/mermaid.css?1752202651" rel="stylesheet" />
    <script src="/fcj-ecr-container-registry-workshop/mermaid/mermaid.js?1752202651"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
