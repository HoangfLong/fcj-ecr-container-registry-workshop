<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head><script src="/fcj-ecr-container-registry-workshop/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=fcj-ecr-container-registry-workshop/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.147.9">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/fcj-ecr-container-registry-workshop/images/favicon.png" type="image/png">

    <title>Configure IAM Roles and Policies :: Create a new AWS account.</title>

    
    <link href="/fcj-ecr-container-registry-workshop/css/nucleus.css?1752160083" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/fontawesome-all.min.css?1752160083" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/hybrid.css?1752160083" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/featherlight.min.css?1752160083" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/perfect-scrollbar.min.css?1752160083" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/auto-complete.css?1752160083" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/atom-one-dark-reasonable.css?1752160083" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/theme.css?1752160083" rel="stylesheet">
    <link href="/fcj-ecr-container-registry-workshop/css/hugo-theme.css?1752160083" rel="stylesheet">
    
    <link href="/fcj-ecr-container-registry-workshop/css/theme-workshop.css?1752160083" rel="stylesheet">
    
    

    <script src="/fcj-ecr-container-registry-workshop/js/jquery-3.3.1.min.js?1752160083"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/fcj-ecr-container-registry-workshop/3-iam-configuration/3.1-set-up-iam/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/fcj-ecr-container-registry-workshop/js/lunr.min.js?1752160083"></script>
<script type="text/javascript" src="/fcj-ecr-container-registry-workshop/js/auto-complete.js?1752160083"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/localhost:1313\/fcj-ecr-container-registry-workshop\/";
    
</script>
<script type="text/javascript" src="/fcj-ecr-container-registry-workshop/js/search.js?1752160083"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/1-introduction/" title="Introduction" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/1-introduction/">
          <b> 1. </b>Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/2-prerequisites/" title="Prerequisites" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/2-prerequisites/">
          <b> 2. </b>Prerequisites
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/3-iam-configuration/" title="IAM Configuration" class="dd-item 
        parent
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/3-iam-configuration/">
          <b> 3. </b>IAM Configuration
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/3-iam-configuration/3.1-set-up-iam/" title="Configure IAM Roles and Policies" class="dd-item 
        
        active
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/3-iam-configuration/3.1-set-up-iam/">
          <b> 3.1. </b>Configure IAM Roles and Policies
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/" title="CI/CD with GitHub Actions" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/">
          <b> 4. </b>CI/CD with GitHub Actions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.1-prepare-github-repo/" title="Prepare GitHub Repository" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.1-prepare-github-repo/">
          <b> 4.1. </b>Prepare GitHub Repository
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.2-build-github-actions/" title="GitHub Actions Workflow" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.2-build-github-actions/">
          <b> 4.2. </b>GitHub Actions Workflow
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.3-run-pipeline/" title="Run and Test the Pipeline" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/4.3-run-pipeline/">
          <b> 4.3. </b>Run and Test the Pipeline
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/" title="ECR Security &amp; Lifecycle" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/">
          <b> 5. </b>ECR Security &amp; Lifecycle
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.1-repository-policy/" title="Repository Access Policy" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.1-repository-policy/">
          <b> 5.1. </b>Repository Access Policy
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.2-inspector-vulnerability-scan/" title="Vulnerability Scanning with Inspector" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.2-inspector-vulnerability-scan/">
          <b> 5.2. </b>Vulnerability Scanning with Inspector
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.3-lifecycle-policy/" title="Image Lifecycle Management" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/5-ecr-security-lifecycle/5.3-lifecycle-policy/">
          <b> 4.3. </b>Image Lifecycle Management
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/6-monitoring-alerts/" title="Monitoring &amp; Alerts" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/6-monitoring-alerts/">
          <b> 6. </b>Monitoring &amp; Alerts
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/6-monitoring-alerts/6.1-cloudtrail-cloudwatch/" title="CloudTrail and CloudWatch" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/6-monitoring-alerts/6.1-cloudtrail-cloudwatch/">
          <b> 6.1. </b>CloudTrail and CloudWatch
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fcj-ecr-container-registry-workshop/7-clean-up-resources/" title="Clean-up Resources" class="dd-item 
        
        
        
        ">
      <a href="/fcj-ecr-container-registry-workshop/7-clean-up-resources/">
          <b> 7. </b>Clean-up Resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://aws.amazon.com/blogs"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj"><i class='fab fa-facebook'></i> AWS Study Group - FB Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="http://localhost:1313/fcj-ecr-container-registry-workshop/3-iam-configuration/3.1-set-up-iam/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="http://localhost:1313/fcj-ecr-container-registry-workshop/vi/3-iam-configuration/3.1-set-up-iam/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830891&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>26-11-2023</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng</a>
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/fcj-ecr-container-registry-workshop/'>Container Registry Management with ECR and Security Policies</a> > <a href='/fcj-ecr-container-registry-workshop/3-iam-configuration/'>IAM Configuration</a> > Configure IAM Roles and Policies
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
        <li><a href="#create-and-retrieve-ecr-repository-uri">Create and Retrieve ECR Repository URI</a></li>
        <li><a href="#create-iam-policy-for-ecr-access">Create IAM Policy for ECR Access</a></li>
        <li><a href="#create-iam-user-and-attach-policy-for-cicd">Create IAM User and Attach Policy for CI/CD</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Configure IAM Roles and Policies
            </h1>
          

        



	<p>To ensure our CI/CD pipeline can securely interact with Amazon ECR, we need to configure the appropriate access permissions in AWS IAM. This step involves creating an ECR Repository if one doesn&rsquo;t already exist, then creating an IAM User and assigning the necessary policies.</p>
<h4 id="objectives-of-this-section">Objectives of this section</h4>
<ul>
<li>Create the <code>fcj-workshop-app</code> ECR Repository if it doesn&rsquo;t already exist.</li>
<li>Retrieve the ECR Repository URI.</li>
<li>Create an IAM User with ECR access.</li>
<li>Attach the necessary IAM policies to the IAM User.</li>
</ul>
<h3 id="create-and-retrieve-ecr-repository-uri">Create and Retrieve ECR Repository URI</h3>
<p>We need an ECR Repository to store our container images. If you haven&rsquo;t created it in the &ldquo;Preparation&rdquo; section, follow these steps. Afterward, we will retrieve this repository&rsquo;s URI.</p>
<ol>
<li>
<p><strong>Log in to the AWS Console:</strong> Go to <a href="https://aws.amazon.com/console/">https://aws.amazon.com/console/</a> and sign in.</p>
</li>
<li>
<p><strong>Navigate to the ECR service:</strong> In the search bar, type &ldquo;ECR&rdquo; and select <strong>Elastic Container Registry</strong>.</p>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/001.png"
        alt="Search and select the ECR service in AWS Console">
    </figure>

</li>
<li>
<p><strong>Check and Create Repository:</strong></p>
<ul>
<li>In the ECR dashboard, select <strong>Repositories</strong> in the left navigation pane.</li>
<li><strong>If you DO NOT have</strong> a repository named <code>fcj-workshop-app</code> yet, follow these steps to create one:
<ul>
<li>Click the <strong>Create repository</strong> button.</li>
<li>For <strong>Visibility settings</strong>, choose <strong>Private</strong>.</li>
<li>In the <strong>Repository name</strong> field, enter <code>fcj-workshop-app</code>.</li>
<li>Click the <strong>Create repository</strong> button at the bottom of the page.</li>
</ul>
</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/002.png"
        alt="Create new ECR Repository">
    </figure>

<figure><img src="/fcj-ecr-container-registry-workshop/images/3/0002.png"
        alt="Create ECR Repository">
    </figure>

<ul>
<li><strong>If you ALREADY HAVE</strong> the <code>fcj-workshop-app</code> repository from the preparation section, proceed to the next step.</li>
</ul>
</li>
<li>
<p><strong>Select your Repository and Copy the URI:</strong></p>
<ul>
<li>From the list of repositories, find and click on the <code>fcj-workshop-app</code> repository name.</li>
<li>On the repository details page, you will see the repository <strong>URI</strong>. Copy this URI. It will be similar to: <code>123456789012.dkr.ecr.ap-southeast-1.amazonaws.com/fcj-workshop-app</code> (where <code>123456789012</code> is your AWS account ID and <code>ap-southeast-1</code> is your Region).</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/003.png"
        alt="Select fcj-workshop-app repository and copy URI">
    </figure>


<div class="notices note" ><pre><code>Keep this URI handy. We will need to use it in later GitHub Actions configuration steps to specify the repository where the image will be pushed.
</code></pre>
</div>

</li>
</ol>
<h3 id="create-iam-policy-for-ecr-access">Create IAM Policy for ECR Access</h3>
<p>Instead of using a pre-existing policy, we will create a custom IAM Policy via the console to gain more granular control over the permissions the CI/CD user will have on ECR.</p>
<ol start="5">
<li>
<p><strong>Navigate to the IAM service:</strong> In the AWS Console search bar, type &ldquo;IAM&rdquo; and select <strong>IAM</strong>.</p>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/004.png"
        alt="Search and select the IAM service in AWS Console">
    </figure>

</li>
<li>
<p><strong>Create a new Policy:</strong></p>
<ul>
<li>In the IAM dashboard, select <strong>Policies</strong> in the left navigation pane.</li>
<li>Click the <strong>Create policy</strong> button.</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/005.png"
        alt="IAM dashboard and Create policy button">
    </figure>

</li>
<li>
<p><strong>Choose service and actions:</strong></p>
<ul>
<li>On the <strong>Specify permissions</strong> page, select the <strong>Visual editor</strong> tab.</li>
<li>For <strong>Service</strong>, search for and select <strong>Elastic Container Registry</strong>.</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/011.png"
        alt="Select ECR service in Visual Editor">
    </figure>

<ul>
<li>In the <strong>Actions allowed</strong> section, expand <strong>Write</strong> and select the following actions:
<ul>
<li><code>CompleteLayerUpload</code></li>
<li><code>InitiateLayerUpload</code></li>
<li><code>PutImage</code></li>
<li><code>UploadLayerPart</code></li>
</ul>
</li>
<li>Expand <strong>Read</strong> and select the following actions:
<ul>
<li><code>BatchCheckLayerAvailability</code></li>
<li><code>BatchGetImage</code></li>
<li><code>DescribeImages</code></li>
<li><code>GetDownloadUrlForLayer</code></li>
</ul>
</li>
<li>In the additional <strong>Access level</strong> section, find and select the <code>GetAuthorizationToken</code> action.</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/012.png"
        alt="Select necessary ECR actions">
    </figure>

<ul>
<li>In the <strong>Resources</strong> section, choose <strong>Specific</strong>.</li>
<li>For <strong>repository</strong>, click <strong>Add ARN</strong>.</li>
<li>Enter the following information:
<ul>
<li><strong>Region:</strong> Select your AWS Region (e.g., <code>ap-southeast-1</code>).</li>
<li><strong>Account ID:</strong> Enter your AWS account ID.</li>
<li><strong>Repository name:</strong> Enter <code>fcj-workshop-app</code>.</li>
</ul>
</li>
<li>Click <strong>Add ARN</strong>.</li>
<li>For the <code>GetAuthorizationToken</code> resource (if this option is separate), leave it as <strong>Any</strong> or add a separate line for this action with <code>Resource: *</code> if necessary. (Typically, <code>GetAuthorizationToken</code> is not restricted to a specific repository resource but rather by account/region).</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/013.png"
        alt="Configure specific resources for ECR">
    </figure>


<div class="notices note" ><pre><code>The selected permissions (`ecr:*` for specific actions) allow the user to perform image push and pull operations.
`ecr:GetAuthorizationToken`: Allows the user to obtain an authentication token to log Docker into ECR.
`Resource`: We specify that this policy applies only to your `fcj-workshop-app` repository, adhering to the principle of least privilege.
</code></pre>
</div>

</li>
<li>
<p><strong>Add Tags (Optional):</strong> You can add tags for easier management. Click <strong>Next: Review policy</strong>.</p>
</li>
<li>
<p><strong>Review and Create Policy:</strong></p>
<ul>
<li>For <strong>Policy name</strong>, enter <code>fcj-ecr-ci-cd-policy</code>.</li>
<li>(Optional) Enter a <strong>Description</strong>. Enter <code>policy for CI-CD</code>.</li>
<li>Click the <strong>Create policy</strong> button.</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/015.png"
        alt="Name and review IAM Policy">
    </figure>


<div class="notices tip" ><pre><code>Creating a custom policy like this allows you more precise control over the permissions granted to a user or role. This is a better practice than assigning broader managed policies for CI/CD purposes.
</code></pre>
</div>

</li>
</ol>
<h3 id="create-iam-user-and-attach-policy-for-cicd">Create IAM User and Attach Policy for CI/CD</h3>
<p>Now we will create an IAM User and attach the custom policy <code>fcj-ecr-ci-cd-policy</code> we just created to this user.</p>
<ol start="10">
<li>
<p><strong>Navigate to the IAM service:</strong> Ensure you are in the IAM dashboard.</p>
</li>
<li>
<p><strong>Create a new User:</strong></p>
<ul>
<li>In the IAM dashboard, select <strong>Users</strong> in the left navigation pane.</li>
<li>Click the <strong>Create user</strong> button.</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/016.png"
        alt="IAM dashboard and Create user button">
    </figure>

<ul>
<li>For <strong>User name</strong>, enter <code>fcj-ecr-ci-cd-user</code>.</li>
<li>Choose <strong>Provide user access to the AWS Management Console</strong> for the CI/CD user.</li>
<li>Click <strong>Next</strong>.</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/017.png"
        alt="Set up user name and access options">
    </figure>

</li>
<li>
<p><strong>Set permissions:</strong></p>
<ul>
<li>On the <strong>Set permissions</strong> page, select <strong>Attach policies directly</strong>.</li>
<li>In the search box, type <code>fcj-ecr-ci-cd-policy</code> (the name of the policy you just created) and select this policy.</li>
<li>Click <strong>Next</strong>.</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/018.png"
        alt="Attach custom policy fcj-ecr-ci-cd-policy">
    </figure>

</li>
<li>
<p><strong>Review and Create User:</strong></p>
<ul>
<li>On the <strong>Review and create</strong> page, review the settings.</li>
<li>Click the <strong>Create user</strong> button.</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/019.png"
        alt="Review information and create user">
    </figure>

</li>
<li>
<p><strong>Save Access Key:</strong></p>
<ul>
<li>After the user is created, you will see a success message. Click <strong>View user</strong> or go back to the user list and click on the <code>fcj-ecr-ci-cd-user</code> you just created.</li>
<li>Navigate to the <strong>Security credentials</strong> tab.</li>
<li>In the <strong>Access keys</strong> section, click <strong>Create access key</strong>.
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/020.png"
        alt="Create Access Key for IAM User">
    </figure>
</li>
</ul>
</li>
<li>
<p>Choose <strong>Third-party service</strong> as the use case.
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/021.png"
        alt="Save Access Key ID and Secret Access Key">
    </figure>
</p>
<ul>
<li>Check the confirmation box and click <strong>Next</strong>.</li>
</ul>
</li>
<li>
<p>(Optional) Enter a description for the Access Key (e.g., <code>for-github-actions</code>).</p>
<ul>
<li>Click <strong>Done</strong>.</li>
</ul>
<figure><img src="/fcj-ecr-container-registry-workshop/images/3/022.png"
        alt="Access Key ID and Secret Access Key">
    </figure>


<div class="notices warning" ><p><strong>The Secret Access Key is displayed ONLY ONCE immediately after creation.</strong> Make sure you copy both the <strong>Access Key ID</strong> and <strong>Secret Access Key</strong> and store them in a secure place. You will not be able to view this Secret Access Key again after closing this window. We will need to use them to configure GitHub Actions in later sections.</p>
</div>


<div class="notices tip" ><p>In a real production environment, using an IAM Role with OpenID Connect (OIDC) is the more recommended method for granting permissions to CI/CD. This approach avoids the need to store long-lived Access Keys, enhancing security. However, for simplicity in this workshop, we will use Access Keys.</p>
</div>

</li>
</ol>
<hr>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/fcj-ecr-container-registry-workshop/3-iam-configuration/" title="IAM Configuration"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/fcj-ecr-container-registry-workshop/4-ci-cd-with-github-actions/" title="CI/CD with GitHub Actions" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/fcj-ecr-container-registry-workshop/js/clipboard.min.js?1752160083"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/perfect-scrollbar.min.js?1752160083"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/perfect-scrollbar.jquery.min.js?1752160083"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/jquery.sticky.js?1752160083"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/featherlight.min.js?1752160083"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/highlight.pack.js?1752160083"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/fcj-ecr-container-registry-workshop/js/modernizr.custom-3.6.0.js?1752160083"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/learn.js?1752160083"></script>
    <script src="/fcj-ecr-container-registry-workshop/js/hugo-learn.js?1752160083"></script>

    <link href="/fcj-ecr-container-registry-workshop/mermaid/mermaid.css?1752160083" rel="stylesheet" />
    <script src="/fcj-ecr-container-registry-workshop/mermaid/mermaid.js?1752160083"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
